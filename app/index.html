<!DOCTYPE html>
<html class="no-js">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Custanet</title>

    <link href="css/bootstrap.css" rel="stylesheet">
    <link rel="stylesheet" href="styles/custanetcenter.css">
    <link href="css/sb-admin.css" rel="stylesheet">
    <link rel="stylesheet" href="font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="http://cdn.oesmith.co.uk/morris-0.4.3.min.css">
    
  
  <!-- endbuild -->
  <script>
  	var ccnsLen =  {{ccns|length }};
  	var ccns =[{% for ccn in ccns %}{"url":"{{ccn.url.id}}","ttl":"{{ccn.url.ttl}}",
  	"usr":"{% for usr in ccn.usr %}{{usr}}{% if loop.index != loop.length %},{% endif %}{% endfor %}","txt":"{{ccn.txt}}","dat":"{{ ccn.dat |timeJST }}","pub":"{{ ccn.pub }}","key":"{{ccn.key}}","tag":"{% for tag in ccn.tag %}{{tag | tag2Name}}{% if loop.index != loop.length %},{% endif %}{% endfor %}"}  {% if loop.index != loop.length %},{% endif %}  {% endfor %}];		
  </script>
 
  <!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
  <script>
    (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
    function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
    e=o.createElement(i);r=o.getElementsByTagName(i)[0];
    e.src='//www.google-analytics.com/analytics.js';
    r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
    ga('create','UA-XXXXX-X');ga('send','pageview');
  </script> 
 
     
</head>


<body ng-app="customInterpolationApp">
  <!--[if lt IE 7]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
      <![endif]-->

<div id="wrapper">

     <!-- Sidebar -->
      <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
	      {%if signin == True %}
	      <a class="navbar-brand" href="javascript:(function(){var g=window.document.createElement('script');g.src='{{debugStr}}/js/Custanet.js';var j=window.document.getElementsByTagName('head');j.item(0).appendChild(g);})();">Custanet</a>
	      {% else %}
	      <a class="navbar-brand" href="/">Custanet</a>
	      {% endif %}   
        </div>
       
       
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse navbar-ex1-collapse">
          <ul class="nav navbar-nav side-nav">
            <li>      
		     {% if ivts|length > 0 %} 
		        <div id="left-pannel-invitation">
		          <label>Invitation</label>
		          <fieldset>
		          {% for ivt in ivts %} 
		            <label class="checkbox">
		              <input type="checkbox" class="invitation" value="{{ivt.id}}">{{ivt.nam}} 
		            </label>
		          {% endfor %} 
		            <button id="invite-btn" type="submit" class="btn btn-default btn-sm">Invite</button>
		          </fieldset>
		          <div id="invitebtnmsg">Invited</div>
		        </div>
		      {% endif %} 
            </li>
            <li>
		      <div id="left-pannel">      
		        <div id="left-pannel-request">
		          <div class="form-group">
		            <label for="email">Friend Reauest</label>
		            <input id="email" name="email" type="email" class="form-control input-sm" placeholder="Enter email or nickname">
		          </div>
		          <button id="request-btn" type="submit" class="btn btn-default btn-sm">Send Request</button>
		          <div id="friendrequestsended">friend request sended</div>
		        </div>
		        <div style="clear:both;"></div>
		        <div id="left-pannel-pub" >
		          <fieldset>
		            <label class="checkbox">
		              <input type="checkbox">Private 
		            </label>
		            <label class="checkbox">
		              <input type="checkbox">Public 
		            </label>
		            <label class="checkbox">
		              <input type="checkbox">Friends 
		            </label>
		          </fieldset>
		          <fieldset id="left-pannel-friends">
		          {% for fri in fris %} 
		            <label class="checkbox">
		              <input class="friend-check" type="checkbox" value="{{fri.id}}">{{fri.nam}} 
		            </label>
		          {% endfor %} 
		          {% if fris|length >0 %} 
		            <button id="delete-btn" type="submit" class="btn btn-default btn-sm">Delete</button>
		          {% endif%}
		          </fieldset>
		        </div>
		      </div> 
            </li>
          </ul>

          <ul class="nav navbar-nav navbar-right navbar-user">
            <li class="dropdown messages-dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-envelope"></i> Messages <span class="badge">7</span> <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li class="dropdown-header">7 New Messages</li>
                <li class="message-preview">
                  <a href="#">
                    <span class="avatar"><img src="http://placehold.it/50x50"></span>
                    <span class="name">John Smith:</span>
                    <span class="message">Hey there, I wanted to ask you something...</span>
                    <span class="time"><i class="fa fa-clock-o"></i> 4:34 PM</span>
                  </a>
                </li>
                <li class="divider"></li>
                <li><a href="#">View Inbox <span class="badge">7</span></a></li>
              </ul>
            </li>
            <li class="dropdown alerts-dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-bell"></i> Alerts <span class="badge">3</span> <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="#">Default <span class="label label-default">Default</span></a></li>
                <li><a href="#">Danger <span class="label label-danger">Danger</span></a></li>
                <li class="divider"></li>
                <li><a href="#">View All</a></li>
              </ul>
            </li>
            <li class="dropdown user-dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-user"></i> 
			      {%if signin == True %} 
			      {{name}}
			      {% else %}
			      unknown
			      {% endif %}
                <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
                <li><a href="#"><i class="fa fa-user"></i> Profile</a></li>
                <li><a href="#"><i class="fa fa-envelope"></i> Inbox <span class="badge">7</span></a></li>
                <li><a href="#"><i class="fa fa-gear"></i> Settings</a></li>
                <li class="divider"></li>
		        {% if login == True%} 
		          <li><a href="{{logouturl}}"><i class="fa fa-power-off"></i> Log Out</a></li>
		        {% endif %} 
		        {%if signin == True %} 
		          <li><a><i class="fa fa-twitter"></i> twitter</a> </li>
		        {% endif %} 
              </ul>
            </li>
          </ul>
        </div><!-- /.navbar-collapse -->
        
        <form class="navbar-form hidden-xs" style="margin: 0px auto;">
         <div class="col-sm-5 col-xs-5" style="display:inline;margin-top: 8px;float: right;">
          <div class="input-group">
            <input class="form-control" name="search" placeholder="Search" autocomplete="off" autofocus="autofocus" type="text">
				<div class="input-group-btn">
			    	<button class="btn btn-default" type="submit">
			          <i class="fa fa-search"></i>
			        </button>
			    </div>
          </div>
         </div>
        </form>
        
      </nav>

<div id="page-wrapper">


  {% if login == True%} 
   {%if signin == False %} 
    <div class="row">
      <div id="nickform" class="col-md-4 centered">
        <div class="form-group">
          <label for="exampleInputEmail1">Nick Name</label>
          <input type="text" id="nickname" class="form-control" placeholder="Enter your nick name">
          <div id="nickErr" style="color:red"></div>
        </div>
        <button id="nickBtn" class="btn btn-default">Submit</button>
      </div>
    </div>
   {% else %} 
    <div class="row">
    
      <div id="main-pannel"  ng-controller="mainCtrl" class="col-lg-12">
        <table id="custanetTable" class="table table-striped table-condensed">
        {% if ccns|length >0 %} 
          <thead>
            <td>
              <input id="allcnts" type="checkbox">
            </td>
            <td>
                {% if ccns|length >0 %} 
			    <div style="float:left;padding: 4px;">
			      <button id="delete-cn-btn" type="submit" class="btn btn-default btn-sm" disabled="disabled">Delete</button>
			    </div>
      			{% endif %} 
            </td>
            <td>
              <select class="form-control" id="displayCount">
                <option>10</option>
                <option>50</option>
                <option>100</option>
                <option>250</option>
                <option>500</option>
              </select>
            </td>
            <td></td>
          </thead>
        {% endif%} 
          <tbody>
            <tr ng-repeat="ccn in ccns" class="/[ccn.pub]/" data-link="/[ccn.url]/">
              <td>
                <input type="checkbox" name="custanet-list" value="/[ccn.key]/">
              </td>
              <td colspan="2">
                <a href="/[ccn.url]/" target="_blank">
                  <div>
                    <span>/[ccn.ttl]/</span>-
                    <span class="txt">/[br(ccn.txt)]/</span>
                    <span ng-repeat="ct in say(ccn.tag)" class="tag label label-success">/[ct]/</span>
                    <span style="float:right">[/[ccn.usr]/]  /[ccn.dat]/</span>
                  </div>
                </a>
              </td>
              <td>
              /[ccn.usr]/
              </td>
            </tr>
          </tbody>
        </table>
        <ul class="pagination">
        	<!--  
          <li id="ppn"><a href="#">&laquo;</a></li>
          <li id="fpn"　class="active"><a href="#">1</a></li>
          <li id="npn"><a href="#">&raquo;</a></li>
          -->
        </ul>

      </div>
    </div>
     {% endif %} 
     
    {% else %}  
        	<div id="loginbtn" class="text-center">
				<a href="{{loginurl}}" class="btn btn-primary">login</a>
			</div>
    {% endif %} 


  </div>
  
  <script src="js/jquery.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.1/angular.min.js"></script>
  <script>
       var customInterpolationApp = angular.module('customInterpolationApp', []).factory('myService', function () {
	        return {
	            say: function (tags) {
	            	var ret = "";
	            	tags = tags.split(",");
	            	if (tags.length==1 && tags[0]==""){tags="";}
	                return tags;
	            },
	            br: function (txt) {
	            	txt = txt.replace(/&lt;br&gt;/g, " ");
	                return txt;
	            }
	        }
	    }); 
	 
	customInterpolationApp.config(function($interpolateProvider) {
	  $interpolateProvider.startSymbol('/[');
	  $interpolateProvider.endSymbol(']/');
	});
	  
	var mainCtrl = function($scope, myService) {
	    $scope.ccns = ccns;
	    $scope.say = myService.say;
	    $scope.br = myService.br;
	}
  </script>
  <script src="js/bootstrap.js"></script>
  <script src="js/custanetcenter.js"></script>
  


</body>
</html>